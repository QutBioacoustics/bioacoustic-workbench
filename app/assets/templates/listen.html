<div id="content" data-ng-controller="ListenCtrl">
    <script type="text/javascript" id="">
        // temporary init script - intended fore removal

        $(document).ready(function() {

        });

    </script>

    <a href="/listen/1bd0d668-1471-4396-adc3-09ccd8fe949a">demo</a>
    <a href="#" ng-click="refresh()">demo</a>

    <div ng-show="errorState">
        Something has gone wrong - can't load this page.
    </div>
    <div ng-hide="errorState">
    <h1>Listen</h1>

    <p>Listen and annotate.</p>

    <h3>Spectrogram</h3>
    <baw-annotation-viewer model="spectrogram"></baw-annotation-viewer>

    <h3>Audio Controls</h3>
    <audio id="main-player" controls>
        <source ng-src="{{recordingurl}}">
        Your browser does not support the audio element.
    </audio>

    <h3>
        Annotation edit
    </h3>

        <form name="annotationEditForm" ng-model="selectedAnnotation">
            <label>
                <span>Tags</span>
                <em>--TODO: support for proper tagging control--</em><br/>
                <select ng-multiple="true" tags multiple ui-select2="{allowClear:true}" ng-model="selectedAnnotation.audio_event_tags"  >
                    <option ng-repeat="t in tags" value="{{t.id}}" >{{t.text}}<!-- ng-show={{t.type_of_tag}}-->, {{t.type_of_tag}} <!-- --></span></option>
                </select>


            </label>

            <label>
                <span>Duration (seconds)</span></label>
                <input type="text" min="{{limits.time_min}}" max="{{limits.time_max}}" required  ng-model="selectedAnnotation.start_time_seconds" />
                &nbsp;to&nbsp;
                <input type="text" min="{{limits.time_min}}" max="{{limits.time_max}}" required  ng-model="selectedAnnotation.end_time_seconds" />

            <label>
                <span>Frequency</span> </label>
                <input type="text" min="{{limits.freq_min}}" max="{{limits.freq_max}}" required  ng-model="selectedAnnotation.low_frequency_hertz" />
                &nbsp;to&nbsp;
                <input type="text" min="{{limits.freq_min}}" max="{{limits.freq_max}}" required  ng-model="selectedAnnotation.high_frequency_hertz" />



            <fieldset>
                <legend>Annotation options</legend>
                    <label>
                        <input type="checkbox" ng-model="selectedAnnotation.is_reference">&nbsp;Is reference tag?
                    </label>
            </fieldset>
            <p>
            data for tag: ({{selectedAnnotation.start_time_seconds}}, {{selectedAnnotation.end_time_seconds}}); ({{selectedAnnotation.low_frequency_hertz}}, {{selectedAnnotation.high_frequency_hertz}}); {{selectedAnnotation.is_reference}};
                <span ng-bind="selectedAnnotation.tags"></span>
            </p>
            <button type="button" ng-click="reset()">Clear</button>
            <button ng-click="addAnnotation()">Add annotation</button>

        </form>

    <h3>Annotations</h3>
    <table>
        <thead>
            <tr>
                <th>Annotation ID</th>
                <th>Audio Recording</th>
                <th>Created At</th>
                <th>Created By</th>
                <th>Deleted At</th>
                <th>Deleted By</th>
                <th>Updated At</th>
                <th>Updated By</th>
                <th>Tags</th>
                <th>Time Range</th>
                <th>Frequency Range</th>
            </tr>
        </thead>
        <tbody>
        <tr ng-repeat="ae in audio_events">
            <td>{{ae.id}}</td>
            <td><a ng-href="/recordings/{{ae.audio_recording.uuid}}" class="short-guid" >{{ae.audio_recording.uuid}}</a></td>
            <td>{{ae.created_at}}</td>
            <td>{{ae.creator_id}}</td>
            <td>{{ae.deleted_at}}</td>
            <td>{{ae.deleter_id}}</td>
            <td>{{ae.updated_at}}</td>
            <td>{{ae.updater_id}}</td>
            <td><span ng-repeat="t in ae.audio_event_tags">{{t.tag_id}},</span></td>
            <td>{{ae.start_time_seconds}} - {{ae.end_time_seconds}}</td>
            <td>{{ae.low_frequency_hertz}} - {{ae.high_frequency_hertz}}</td>
        </tr>
        </tbody>
    </table>

    <baw-debug-info/>
    </div>
</div>